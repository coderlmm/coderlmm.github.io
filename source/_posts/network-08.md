---
title: 计算机网络自顶向下方法读书笔记（第八章）
date: 2019-06-25
tags: 
    - network
catalog: true
---

前面几章对计算机网络中的各个层做了详细的介绍，本章主要讲的是另外一个大的话题，网络安全。

网络安全具体就是指如何在网络上进行安全的通信，若要达到该目标，则必须具备以下特性：

+ 机密性：近发送方和接收方能够理解传输的报文，加密。
+ 报文完整性：确保报文在传输过程中不被篡改。
+ 端点鉴别：发送方和接收方必须能确认对方的身份。
+ 运行安全性：确保整个局域网的运行安全。

### 密码学

发送方将明文通过加密算法生成密文然后发送出去，接收方收到密文之后，通过解密算法得到明文。所以发送方和接收方都必要知道加密和解密算法才行。但如果这个加密算法被公布出来之后遭到中间人劫持咋办，但是又不可能每两个人之间的通信就自己协商一套加密算法，这成本太高了。

所以比较通用的解决办法就是俩人协商好共用一个秘钥，通过公开的加密算法来加密和解密报文，这样即使遭到中间人劫持，由于中间人没有秘钥也是看不到明文的，这就是对称加密。

但是如果两人相距甚远，怎么在不见面的情况下安全的把秘钥传给对方呢？（下文会说）

### 对称密码加密

#### 凯撒密码

简单来说就是字母推移，将明文字母按照 k 往后推移。比如 k = 3，那么明文”a“将变成密文”d“，明文”b“将变成密文”e“，以此列推。

此方法太过简单，因为最多试 25 次就可以破解出明文了。

#### 单码代替密码

凯撒密码的改进方案，具体做法就是定义一个明文和密文的对照表， 明文中的每个字母都对应一个密文字母，不一定是按顺序往后推移的，可能的配对顺序一下子就提升到了 26!。穷举破解难度增加了不少。

但此方法也有局限，因为明文和密文是一一对应的，但是在典型的英文资料中，每个字母出现的频率是可知的，所以只要截取足够多的密文，就可以很容易破解出明文。

#### 多码代替密码

单码代替密码的改进方案，使用多个单码密码，加密时使用不同的单码密码。比如第一个字母用 C1 加密，第二个字母用 C2 加密，以此类推…

### 非对称密码加密

想想一下，每次通信前，双方都要协商秘钥，也是很烦的一件事。针对这点不足，非对称加密横空出世。

其思想为：每个人都有一对秘钥，称为公钥和私钥，公钥是公开的，全世界都可以知道你的公钥，但私钥只有你本人自己知道。当别人想给你发消息时，用公钥加密，你收到消息之后，用私钥解密即可。因为私钥只有你自己知道，所以即使消息被劫持，也无法解密，即使是发送者自己也是无法解密的。

安全性是保证了，但同时也引入一个问题。就是全世界的人都知道你的公钥，你怎么确定给你发消息的人的身份呢？而非对称加密不存在这个问题，因为发送方知道共享秘钥的事实就已经向接收方隐含的证实了自己的身份。

另外非对称加密算法的效率较对称加密效率较低，所以当两个人想通信时，可以先用非对称加密算法将秘钥发给对方，之后的通信采用对称加密算法，既解决了身份验证问题，又解决了效率问题。

### 报文完整性

报文完整性是指，接收方在收到报文之后，要确认以下 2 个信息：

+ 报文确实源自发送方
+ 报文在传输途中没有被篡改

但是上文不是说了采用非对称密码加密 + 对称加密传输时解决了确认发送方身份的问题吗。是的没错，但是有一个前提，就是你所使用的公钥真的是发送发的公钥，而不是其他人（中间人劫持）的公钥。所以如何让公钥具有可信度是一个大的前提。

再来说说报文篡改，如果中间人改了你们的密文，接收方知道吗？很显然加密算法只保证了报文的机密性，而保证不了完整性。

#### 密码散列函数

找到任意两个不同的报文 x 和 y 使得 H(x) = H(y) 在理论和计算上是不可能的，这就是散列函数。

所以发送方可以发送(m, H(m)) 报文，接收方接收到报文(m, h)，如果 H(m) = h 则说明报文未被更篡改过。

但是仍可能遭到中间人攻击，因为算法是公开的，所以中间人可以生成 (m’, H(m’))，接收方收到报文后仍能通过验证。

所以为了报文的完整性，仍需增加一个秘钥，称为鉴别秘钥。假设为 s。

则：发送方发送(m + s, H(m + s)) 报文，接收方接收到报文(m, h)，如果 H(m + s) = h 则说明报文未被更篡改过。由于中间人不知道 s，所以当他以同样的方式发送报文时，接收方会验签失败。

#### 数字签名

数字签名同样可以解决报文完整性问题。

发送方用自己的私钥加密报文 K-(m)，验签时只需要将发送方的公钥作用于其数字签名 K+( K-(m))，由此得到 m。

因为是谁签名该报文或文档，都必须在计算签名 K-(m) 过程中使用 K- 这个私钥使得 K+( K-(m)) = m。而知道 K-这个私钥的人只有发送方自己。

所以数字签名确保报文完整性的同时，还可以确认报文的源头。

但是其效率较低。

#### 公钥认证

将公钥和特定实体绑定通常是由认证中心（CA）来做的。

CA 证实一个人，一台机器的真实身份。至于如何认证，则没有强制要求，反正就是无条件信任 CA。

一旦 CA 验证了某个实体的身份，则会生成一个把实体身份和其公钥绑定起来的证书。