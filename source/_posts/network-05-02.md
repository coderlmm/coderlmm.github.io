---
title: 计算机网络自顶向下方法读书笔记（第五章之二）
date: 2019-06-19
tags: 
    - network
catalog: true
---

这周看的主要是关于链路层的知识，链路层处于网络层之下，物理层之上。

### 链路层寻址和 ARP

网络接口都有链路层地址（MAC 地址），所以路由器和交换机以及网卡都有自己特有的 MAC 地址，该地址不因主机的物理位置变化而变化。并且这个地址是全球唯一的，没有重复的。

**目前已经学到的地址包括：应用层的主机名，网络层的 IP 地址以及链路层的 MAC 地址。**

链路层做的事是将网络层提供的数据包封装进自己的帧中，然后加上 MAC 地址等信息之后把帧发送出去，也就是说发送方不仅要知道接收方的 IP 地址（网络层需要），还需要清楚接收方的 MAC 地址（链路层需要）。这两个地址间的转换就是通过 ARP 协议来搞定的。其实就是主机或者路由器维护一个 ARP 表，将 IP 地址和 MAC 地址一一对应起来，每条记录都有一个过期时间，如果在该表中没有要查的 IP 的记录， 则进行 ARP 广播。

**查询 ARP 报文在广播帧中发送，而响应 ARP 报文在一个标准应答中发送。因为 ARP 报文既包含链路层地址，同时也包含网络层地址，所以可以把 ARP 协议堪称是跨越链路层和网络层的协议。**

交换机不仅是无碰撞的，也是名副其实的存储转发分组交换了。在第二层工作，而路由器在第三层工作。其内部维护着一个**交换机表**，分组转发基于 MAC 地址，而不是 IP 地址。

> 交换机毒化：攻击方向交换机发大量的具有不同的源 MAC 地址的分组，用伪造项快速占满交换机表，之后合法的请求就没有了可用的空间，然后该交换机就会广播大多数帧，攻击者就可以用工具来嗅探这些被广播的帧。

以太网帧承载了网络层的 IP 数据报，最大传输单元为 1500 个字节。

### Web 页面的请求历程

Bob 启动他的主机，首先运行的协议就是 DHCP 来为自己求得一个 IP 地址。因为没有 IP 地址是发不出去数据的。

然后 Bob 在地址栏输入域名是，操作系统会自动生成一个 DNS 查询，以求得域名对应的 IP 地址。

各项准备工作都做好了，终于可以发起总攻了，下面就是比较熟悉的流程了，TCP 套接字，三次握手后客户端和服务器建立连接，然后就可以正常通信了。